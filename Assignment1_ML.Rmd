---
title: "Assignment1_ML"
author: "Tanu"
date: "1/26/2020"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library (viridis)
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
fig.width = 8, 
 fig.height = 6,
 out.width = "90%"
)
options(
 ggplot2.continuous.colour = "viridis",
 ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))

set.seed(1)

```

```{r}
bc_data = read_csv(file = "Data/dataR2.csv") %>% 
  janitor::clean_names()
```
1. Construct a table providing summaries of the quantitative features of the dataset.
Summaries should include the mean, median, minimum value, and maximum value. If
you are unable to construct a formatted table within R, you can print raw output, but
then comment the output to identify the answer that was requested.

```{r}
bc_data %>% 
select(-classification) %>%   
summary(bc_data) %>% 
  knitr::kable(col.names = c("Age",
                            "BMI",
                            "Glucose",
                            "Insulin",
                            "Homa",
                            "Leptin",
                            "Adiponectin",
                            "Resistin",
                            "mcp_1"))
```
2. Recode BMI into the WHO-defined categories below +Severely underweight - BMI less
than 16.5kg/m^2 +Underweight - BMI under 18.5 kg/m^2 +Normal weight - BMI
greater than or equal to 18.5 to 24.9 kg/m^2 +Overweight – BMI greater than or equal
to 25 to 29.9 kg/m^2 +Obesity class I – BMI 30 to 34.9 kg/m^2 +Obesity class II – BMI
35 to 39.9 kg/m^2 +Obesity class III – BMI greater than or equal to 40 kg/m^2

```{r}
Breast_Cancer=
  bc_data %>% 
  mutate(BMI_CAT=
           case_when(bmi < 16.5 ~ "Severly Underweight",
                     bmi >= 16.5 & bmi < 18.5 ~ "Underweight",
                     bmi >= 18.5 & bmi <= 24.9 ~ "Normal Weight",
                     bmi >= 25 & bmi <= 29.9 ~ "Overweight",
                     bmi >= 30 & bmi <= 34.9 ~ "Obesity Class I",
                     bmi >= 35 & bmi <= 39.9 ~ "Obesity Class II",
                     bmi >= 40 ~ "Obesity Class III"))
```
3.Create a bar chart showing the proportion of breast cancer cases and controls within
each BMI category
```{r}
Chart_Data =
Breast_Cancer %>% 
  mutate(classification = recode( classification, "1" = "Control", "2" = "Case"))
```

```{r}
Chart_Data %>% 
  ggplot(aes(x=BMI_CAT, fill=classification)) +
  geom_bar()
```
 
